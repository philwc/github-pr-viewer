(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,a){e.exports=a(299)},203:function(e,t){},299:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(126),o=a.n(l),c=a(301),i=(a(133),a(135),a(137),a(8)),s=a(9),u=a(10),m=a(11),p=a(12),d=a(19),h=a(2),v=a(78),b=Object(v.storageFactory)(localStorage),f=(Object(v.storageFactory)(sessionStorage),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={collapse:!1},a.onClick=a.onClick.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.setState({collapse:!this.state.collapse})}},{key:"render",value:function(){var e;return e=null===b.getItem("githubToken")?r.a.createElement(h.NavLink,{to:"/auth"},"Add Access Token"):r.a.createElement(h.NavLink,{to:"/auth"},"Remove Access Token"),r.a.createElement(h.Navbar,{style:{backgroundColor:"#ec407a"},dark:!0,expand:"md",scrolling:!0,fixed:"top"},r.a.createElement(h.NavbarBrand,{href:"/github-pr-viewer"},r.a.createElement("strong",null,"Github PR Viewer")),r.a.createElement(h.NavbarToggler,{onClick:this.onClick}),r.a.createElement(h.Collapse,{isOpen:this.state.collapse,navbar:!0},r.a.createElement(h.NavbarNav,{left:!0},r.a.createElement(h.NavItem,null,r.a.createElement(h.NavLink,{to:"/repos"},"Select Repositories"))),r.a.createElement(h.NavbarNav,{right:!0},r.a.createElement(h.NavItem,null,e))))}}]),t}(r.a.Component)),k=a(79),E=a.n(k),g=a(16),C=a(18),O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).toggle=a.toggle.bind(Object(d.a)(Object(d.a)(a))),a.state={collapse:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"toggle",value:function(){this.setState({collapse:!this.state.collapse})}},{key:"render",value:function(){var e,t=this.props.pulls,a=t.map(function(e){var t=E()(e.updated_at).fromNow(),a=E()(e.updated_at).format("dddd, MMMM Do YYYY, h:mm:ss a");return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement("a",{color:"primary",href:e.html_url,target:"_blank",rel:"noopener noreferrer"},"#",e.number," - ",e.title)),r.a.createElement("td",null,r.a.createElement("img",{src:e.user.avatar_url,style:{width:"25px"},className:"rounded-circle mr-3",alt:"{pull.user.login}"}),r.a.createElement("span",null,e.user.login)),r.a.createElement("td",{title:a},t))});return e=this.state.collapse?r.a.createElement("span",null,r.a.createElement(g.a,{icon:C.b})," Hide"):r.a.createElement("span",null,r.a.createElement(g.a,{icon:C.a})," Show (",t.length,")"),t.length>0?r.a.createElement("div",null,r.a.createElement(h.Button,{size:"sm",color:"primary",onClick:this.toggle},e),r.a.createElement(h.Collapse,{isOpen:this.state.collapse},r.a.createElement(h.Table,null,r.a.createElement(h.TableHead,null,r.a.createElement("tr",null,r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Author"),r.a.createElement("th",null,"Updated"))),r.a.createElement(h.TableBody,null,a)))):r.a.createElement("p",null,"No Pull Requests Found")}}]),t}(r.a.Component),w=a(127),y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={error:null,pullsLoaded:!1,repoLoaded:!1,pulls:[],repo:null},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.props.octokit&&this.props.octokit.auth){this.loadData();var e=setInterval(this.loadData.bind(this),6e5);this.setState({intervalId:e})}else this.setState({repoLoaded:!0,error:{message:"Not Authenticated"}})}},{key:"componentWillUnmount",value:function(){var e=this.state.intervalId;e&&clearInterval(e)}},{key:"loadData",value:function(){var e=this;this.props.octokit.pullRequests.getAll({owner:this.props.repo.owner,repo:this.props.repo.name}).then(function(t){e.setState({pullsLoaded:!0,pulls:t.data})},function(t){e.setState({pullsLoaded:!0,error:t})}),this.props.octokit.repos.get({owner:this.props.repo.owner,repo:this.props.repo.name}).then(function(t){e.setState({repoLoaded:!0,repo:t.data})},function(t){e.setState({repoLoaded:!0,error:t})})}},{key:"removeRepo",value:function(){this.props.removeRepoCallback(this.props.repo)}},{key:"refresh",value:function(){this.loadData()}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.repoLoaded,n=e.pullsLoaded,l=e.pulls,o=e.repo,c="";t?c=r.a.createElement(h.CardText,null,"Error: ",t.message):n||a||(c=r.a.createElement(g.a,{className:"fa-pulse",icon:C.c}));var i=r.a.createElement("span",null,r.a.createElement(g.a,{icon:w.a}),"\xa0",this.props.repo.owner,"/",this.props.repo.name);return a&&o&&(i=r.a.createElement("a",{className:"text-muted",href:o.html_url,target:"_blank",rel:"noopener noreferrer"},i)),r.a.createElement(h.Card,null,r.a.createElement(h.CardBody,null,r.a.createElement(h.CardTitle,null,r.a.createElement(h.Row,null,r.a.createElement(h.Col,{className:"col-10"},i),r.a.createElement(h.Col,{className:"col-2 text-right"},r.a.createElement("button",{className:"btn btn-link text-muted m-0 p-0",onClick:this.refresh.bind(this)},r.a.createElement(g.a,{icon:C.d})),r.a.createElement("button",{className:"btn btn-link text-muted m-0 p-0",onClick:this.removeRepo.bind(this)},r.a.createElement(g.a,{icon:C.e}))))),c,n&&r.a.createElement(O,{pulls:l})))}}]),t}(r.a.Component),j=a(300),N=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).removeRepoCallback=function(e){var t=JSON.parse(b.getItem("githubRepos")).filter(function(t){return t.id!==e.id});b.setItem("githubRepos",JSON.stringify(t)),a.setState({repositories:t})},a.state={repositories:[]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(b.getItem("githubRepos"));null===e&&(e=[]),this.setState({repositories:e})}},{key:"render",value:function(){var e,t=this,a=this.state.repositories;if(a.length>0){var n=a.map(function(e,a){return r.a.createElement(h.Col,{className:"col-4 mt-3",key:a},r.a.createElement(y,{removeRepoCallback:t.removeRepoCallback,octokit:t.props.octokit,repo:e}))});e=r.a.createElement(h.Row,null,n)}else e=r.a.createElement(h.Row,null,r.a.createElement(h.Col,null,r.a.createElement("p",null,"No Repositories Configured"),r.a.createElement("p",null,r.a.createElement(j.a,{to:"/repos"},"Configure some now!"))));return e}}]),t}(r.a.Component),T=a(128),R=a.n(T),S={get:function(){var e=new R.a,t=b.getItem("githubToken");return null!==t?(e.authenticate({type:"token",token:t}),e.auth=!0):e.auth=!1,e}},I=a(302),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={token:"",savedToken:b.getItem("githubToken"),redirect:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"saveToken",value:function(e){e.preventDefault(),b.setItem("githubToken",this.state.token),this.props.authCallback(),this.redirect(e)}},{key:"removeToken",value:function(e){e.preventDefault(),b.removeItem("githubToken"),this.props.authCallback(),this.redirect(e)}},{key:"handleChange",value:function(e){this.setState({token:e.target.value})}},{key:"redirect",value:function(e){e.preventDefault(),this.setState({redirect:!0})}},{key:"render",value:function(){var e=this.state,t=e.redirect,a=e.savedToken,n=r.a.createElement(h.Card,null,r.a.createElement(h.CardBody,null,r.a.createElement(h.CardTitle,null,"Authentication Required"),r.a.createElement(h.CardText,null,"In order to make requests to Github, a personal access token is required. To generate, ",r.a.createElement("a",{href:"https://github.com/settings/tokens/new?scopes=repo&description=Github%20PR%20Viewer",target:"_blank",rel:"noopener noreferrer"},"click here"),". Once generated, copy/paste the token below & click save."),r.a.createElement(h.Input,{value:this.state.token,onChange:this.handleChange.bind(this),label:"Github Personal Access Token"}),r.a.createElement(h.Button,{onClick:this.saveToken.bind(this),className:"pull-right"},"Save"))),l=r.a.createElement(h.Card,null,r.a.createElement(h.CardBody,null,r.a.createElement(h.CardTitle,null,"Remove Token"),r.a.createElement(h.CardText,null,"If you remove your access token, the application will not be able to make requests to Github. Are you sure?"),r.a.createElement(h.Button,{color:"danger",onClick:this.removeToken.bind(this),className:"danger pull-right"},"Remove"),r.a.createElement(h.Button,{onClick:this.redirect.bind(this),className:"pull-right"},"Cancel"))),o=r.a.createElement(I.a,{to:"/"});return t?o:null!==a?l:n}}]),t}(r.a.Component),L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={error:null,loaded:!1,redirect:!1,repos:[]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(b.getItem("githubRepos"));null===t&&(t=[]),this.props.octokit&&this.props.octokit.auth?this.props.octokit.repos.getAll({sort:"updated",per_page:100}).then(function(a){var n=[];a.data.forEach(function(e){var a=!1,r=t.find(function(t){return t.id===e.id});r&&(a=r.selected),n.push({id:e.id,owner:e.owner.login,name:e.name,selected:a})}),e.setState({loaded:!0,repos:n})},function(t){e.setState({loaded:!0,error:t})}):this.setState({redirect:!0})}},{key:"addRepo",value:function(e){var t=e.target.checked,a=this.state.repos,n=a.find(function(t){return t.id===parseInt(e.target.value,10)}),r=a.indexOf(n);a.fill(n.selected=t,r,r++),b.setItem("githubRepos",JSON.stringify(a.filter(function(e){return e.selected}))),this.setState({repos:a})}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.redirect,l=a.repos,o=a.loaded,c=r.a.createElement(I.a,{to:"/"});return e=o?l.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(h.Input,{onChange:t.addRepo.bind(t),type:"checkbox",value:e.id,checked:e.selected})),r.a.createElement("td",null,e.owner),r.a.createElement("td",null,e.name))}):r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(g.a,{className:"fa-pulse",icon:C.c}))),n?c:r.a.createElement(h.Row,null,r.a.createElement(h.Col,null,r.a.createElement(h.Table,null,r.a.createElement(h.TableHead,null,r.a.createElement("tr",null,r.a.createElement("th",null,"\xa0"),r.a.createElement("th",null,"Owner"),r.a.createElement("th",null,"Repo Name"))),r.a.createElement(h.TableBody,null,e))))}}]),t}(r.a.Component),B=a(304),D=a(303),A=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).authCallback=function(){a.setState({octokit:S.get()})},a.state={octokit:null},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.authCallback()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement("main",null,r.a.createElement("div",{className:"container-fluid mt-5 pt-5"},r.a.createElement(B.a,null,r.a.createElement(D.a,{path:"/repos",render:function(t){return r.a.createElement(L,Object.assign({},t,{octokit:e.state.octokit}))}}),r.a.createElement(D.a,{path:"/auth",render:function(t){return r.a.createElement(x,Object.assign({},t,{authCallback:e.authCallback}))}}),r.a.createElement(D.a,{path:"/",render:function(t){return r.a.createElement(N,Object.assign({},t,{octokit:e.state.octokit}))}})))))}}]),t}(n.Component),_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(c.a,null,r.a.createElement(A,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/github-pr-viewer",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/github-pr-viewer","/service-worker.js");_?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):M(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):M(e)})}}()}},[[129,2,1]]]);
//# sourceMappingURL=main.6ea793bf.chunk.js.map